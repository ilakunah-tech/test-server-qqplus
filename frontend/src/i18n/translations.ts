import type { Language } from '@/store/settingsStore';

function flatten(obj: Record<string, unknown>, prefix = ''): Record<string, string> {
  const result: Record<string, string> = {};
  for (const [key, value] of Object.entries(obj)) {
    const fullKey = prefix ? `${prefix}.${key}` : key;
    if (value !== null && typeof value === 'object' && !Array.isArray(value)) {
      Object.assign(result, flatten(value as Record<string, unknown>, fullKey));
    } else if (typeof value === 'string') {
      result[fullKey] = value;
    }
  }
  return result;
}

const ru: Record<string, unknown> = {
  nav: {
    dashboard: 'Дашборд',
    roasts: 'Обжарки',
    greenBean: 'Зелёное зерно',
    greenBeanData: 'Ф/Х данные зерна',
    blends: 'Бленды',
    qualityControl: 'Контроль качества',
    schedule: 'Расписание',
    productionTasks: 'Производственные задачи',
    settings: 'Настройки',
  },
  header: {
    hideMenu: 'Скрыть меню',
    showMenu: 'Показать меню',
    tagline: 'РАСКРЫВАЯ ПОТЕНЦИАЛ',
    platform: 'Coffee Roasting Platform',
    themeLight: 'Светлая тема',
    themeDark: 'Тёмная тема',
    langRu: 'Русский',
    langEn: 'English',
    online: 'Online',
    offline: 'Offline',
    logout: 'Выход',
  },
  sidebar: {
    roastingMode: 'Режим обжарки',
    readyToCreate: 'Готов к созданию',
  },
  login: {
    signInToAccount: 'Войдите в аккаунт',
    email: 'Email',
    password: 'Пароль',
    rememberMe: 'Запомнить меня',
    signIn: 'Войти',
    signingIn: 'Вход…',
    invalidEmail: 'Некорректный email',
    passwordRequired: 'Введите пароль',
    loginFailed: 'Ошибка входа',
  },
  common: {
    save: 'Сохранить',
    cancel: 'Отмена',
    close: 'Закрыть',
    delete: 'Удалить',
    edit: 'Редактировать',
    add: 'Добавить',
    search: 'Поиск',
    filter: 'Фильтр',
    refresh: 'Обновить',
    export: 'Экспорт',
    loading: 'Загрузка…',
    noData: 'Нет данных',
    yes: 'Да',
    no: 'Нет',
    showPassword: 'Показать пароль',
    hidePassword: 'Скрыть пароль',
  },
  users: {
    users: 'Пользователи',
    createUser: 'Создать пользователя',
    username: 'Имя пользователя',
    role: 'Роль',
    status: 'Статус',
    active: 'Активен',
    inactive: 'Неактивен',
    actions: 'Действия',
    manageUsers: 'Управление пользователями, ролями и правами. Доступ только для администратора.',
    newPassword: 'Новый пароль',
    leaveEmptyToKeep: 'Оставьте пустым, чтобы не менять',
    editUser: 'Редактировать пользователя',
    creating: 'Создание…',
    saving: 'Сохранение…',
    requiredFields: 'Укажите имя, email и пароль',
    you: '(вы)',
    createFailed: 'Не удалось создать пользователя',
    updateRoleFailed: 'Не удалось обновить роль',
    deleteFailed: 'Не удалось удалить пользователя',
    updateFailed: 'Не удалось обновить пользователя',
    usernameEmailRequired: 'Укажите имя пользователя и email',
    passwordMinLengthAlert: 'Пароль должен быть не менее 8 символов',
    cannotDeleteYourself: 'Нельзя удалить себя',
    confirmDeleteUser: 'Удалить пользователя {name}?',
    loadingUsers: 'Загрузка пользователей…',
    failedToLoadUsers: 'Не удалось загрузить пользователей.',
    addUser: 'Добавить пользователя',
    createNewUser: 'Создать пользователя',
    displayName: 'Отображаемое имя',
    min8Chars: 'Мин. 8 символов',
    allUsers: 'Все пользователи',
    created: 'Создан',
    editTitle: 'Редактировать',
    deleteUserTitle: 'Удалить пользователя',
    cannotDeleteYourselfTitle: 'Нельзя удалить себя',
    noUsersFound: 'Пользователи не найдены.',
  },
  settings: {
    settings: 'Настройки',
    pageSubtitle: 'Машины, профиль, интерфейс и другие параметры',
    machines: 'Машины',
    profile: 'Профиль',
    profileDesc: 'Информация об учётной записи и выход из системы.',
    notifications: 'Оповещения',
    notificationsDesc: 'Управление уведомлениями в реальном времени (WebSocket) и звуковыми сигналами.',
    interface: 'Интерфейс',
    goals: 'Цели',
    about: 'О приложении',
    myMachines: 'Мои машины',
    addFromCatalog: 'Добавить из каталога Artisan',
    orEnterName: 'Или введите название вручную',
    add: 'Добавить',
    machinesInOrg: 'Машины в организации',
    noMachinesYet: 'Пока нет машин. Добавьте из каталога или введите название.',
    addMachinesInSettings: 'Добавьте машины в Настройках',
    addError: 'Ошибка добавления',
    changePassword: 'Сменить пароль',
    currentPassword: 'Текущий пароль',
    newPassword: 'Новый пароль',
    repeatNewPassword: 'Повторите новый пароль',
    minChars: 'Не менее 8 символов',
    changePasswordBtn: 'Сменить пароль',
    passwordChanged: 'Пароль успешно изменён',
    passwordChangeError: 'Ошибка смены пароля',
    logoutAccount: 'Выйти из аккаунта',
    dateFormat: 'Формат даты',
    weightFormat: 'Единицы веса',
    tempFormat: 'Единицы температуры',
    defaultPageSize: 'Размер списка по умолчанию',
    wsNotifications: 'WebSocket-уведомления',
    wsNotificationsDesc: 'Получать push-уведомления о расписании и новых обжарках',
    soundNotifications: 'Звуковые уведомления',
    soundNotificationsDesc: 'Воспроизводить звук при новых событиях',
    enabled: 'Включено',
    aboutApp: 'О приложении',
    aboutDesc: 'Информация о Artisan+ Local Server.',
    version: 'Версия фронтенда',
    artisanConnect: 'Подключение Artisan: укажите URL сервера в настройках Artisan.',
    interfaceDesc: 'Язык, форматы даты, веса, температуры и размер списка по умолчанию.',
    goalsDesc: 'Настройка целей для сравнения обжаренных батчей с референсными профилями.',
    artisanServer: 'Artisan+ Local Server',
    frontendVersion: 'Версия фронтенда',
    compatibleWithArtisan: 'Совместим с Artisan — настольным приложением для профилирования обжарки кофе.',
    passwordsDoNotMatch: 'Пароли не совпадают',
    passwordMinLength: 'Новый пароль должен быть не менее 8 символов',
  },
  roasts: {
    roasts: 'Обжарки',
    addRoast: 'Добавить обжарку',
    date: 'Дата',
    name: 'Наименование',
    warehouse: 'Склад',
    machine: 'Машина',
    operator: 'Оператор',
    greenWeight: 'Начальный вес',
    roastedWeight: 'Конечный вес',
    shrinkage: 'Ужарка',
    dtr: 'DTR',
    beanColor: 'Цвет зерна',
    grindColor: 'Цвет помола',
    coffee: 'Кофе',
    rating: 'Оценка',
    qualityControl: 'КК',
    downloadProfile: 'Скачать профиль',
    uploadProfile: 'Загрузить профиль',
    delete: 'Удалить',
    compare: 'Сравнить',
    export: 'Экспорт',
    printStickers: 'Печать наклеек',
    columns: 'Колонки',
    close: 'Закрыть',
    filters: 'Фильтры',
    byMachine: 'По ростерам',
    byCoffeeBlend: 'По зерну / бленду',
    byRoastName: 'По наименованию обжарки',
    byId: 'По ID',
    byDate: 'По дате',
    byUser: 'По пользователю',
    selectMachine: '— Выберите ростер —',
    selectCoffee: '— Кофе —',
    selectBlend: '— Бленд —',
    partOfName: 'Часть названия',
    apply: 'Применить',
    reset: 'Сбросить',
    exportRoasts: 'Экспорт обжарок',
    format: 'Формат',
    scope: 'Что экспортировать',
    currentPage: 'Текущая страница',
    allFiltered: 'Вся выборка (с учётом фильтров)',
    selectedOnly: 'Только выбранные',
    records: 'записей',
    references: 'Эталоны',
    removeReference: 'Снять эталон',
    removeReferenceConfirm: 'Снять эталон с этой обжарки? Обжарка останется в системе, но перестанет быть эталоном.',
    clickToEdit: 'Нажмите для редактирования',
    inQC: 'Отметить для контроля качества',
    editRoast: 'Редактирование обжарки',
    goalsStatusGreen: 'Все цели выполнены',
    goalsStatusRed: 'Цели не выполнены',
    goalsStatusYellow: 'Отсутствуют данные для проверки',
    deleteError: 'Ошибка удаления',
    saveError: 'Ошибка сохранения',
    removeReferenceError: 'Ошибка снятия эталона',
    selectRoastsForExport: 'Выберите обжарки для экспорта',
    noDataForExport: 'Нет данных для экспорта',
    tabs: 'Вкладки',
    tabRoasts: 'Обжарки',
    tabReferences: 'Референсы',
    filterOptional: 'Фильтр (необязательно):',
    machineOptional: 'Машина (необязательно)',
    refresh: 'Обновить',
    loading: 'Загрузка…',
    actions: 'Действия',
    noReferencesByFilter: 'Нет эталонных обжарок по выбранному фильтру.',
    noReferences: 'Нет эталонных обжарок.',
    selectCoffeeOption: 'Выберите кофе',
    selectBlendOption: 'Выберите бленд',
    blend: 'Бленд',
    exportTitle: 'Artisan+ — Экспорт обжарок',
    exportDate: 'Дата экспорта',
    recordsCount: 'Записей',
    period: 'Период',
    roaster: 'Ростер',
    userFilter: 'Пользователь',
    searchPlaceholder: 'Найти',
    shortName: 'Наим.',
    shortMachine: 'Маш.',
    shortOperator: 'Опер.',
    shortGreenWeight: 'Нач. кг',
    shortRoastedWeight: 'Кон. кг',
    shortBeanColor: 'Цв. зерна',
    shortGrindColor: 'Цв. помола',
    displayInList: 'Отображать в списке',
    filtersTitle: 'Фильтры обжарок',
    addMachinesInSettings: 'Добавьте машины в Настройках',
    noSearchResults: 'По запросу ничего не найдено. Измените поиск или очистите поле.',
    noRoastsToDisplay: 'Нет обжарок для отображения',
    devTimeTitle: 'Время развития / % развития',
    ratingTitle: 'Оценка',
    filterIdPlaceholder: 'Например: 2829',
    dateFrom: 'От',
    dateTo: 'До',
    sameDateHint: 'Оставьте одинаковые даты для одного дня',
    selectUser: '— Выберите пользователя —',
    currentPageRecords: 'Текущая страница ({n} записей)',
    selectedRecords: 'Только выбранные ({n} записей)',
    exportFileHint: 'В файл попадут видимые колонки. Имя файла: roasts_export_ГГГГ-ММ-ДД_ЧЧ-ММ',
    exportButton: 'Экспортировать',
    perPage: 'На странице:',
    noRecords: 'Нет записей',
    showingRange: 'Показано {from}–{to} из {total}',
    customSticker: 'Текстовая наклейка',
    customStickerTitle: 'Печать текстовой наклейки',
    customStickerHint: 'Введите текст, который нужно напечатать на наклейке. Каждая строка будет отдельной строкой на наклейке.',
    customStickerPrint: 'Печать',
    customStickerPreviewLabel: 'Текст наклейки',
    customStickerFont: 'Шрифт',
    customStickerFontSize: 'Размер текста, pt',
    customStickerStyle: 'Стиль',
    customStickerBold: 'Жирный',
    customStickerItalic: 'Курсив',
    customStickerUnderline: 'Подчёркивание',
    customStickerPreview: 'Превью наклейки',
  },
  roastDetail: {
    back: 'Назад',
    profileLoaded: 'Профиль .alog загружен',
    profileNotLoaded: 'Профиль .alog не загружен',
    downloadProfile: 'Скачать профиль',
    uploadProfile: 'Загрузить профиль',
    beansNotes: 'Заметки Beans',
    removeFromReferences: 'Убрать из эталонов',
    removeFromRefConfirm: 'Убрать этот профиль из эталонов?',
    createReference: 'Создать эталон',
    replaceReference: 'Заменить эталон',
    deleteRoast: 'Удалить',
    deleteRoastConfirm: 'Удалить эту обжарку? Склад будет восстановлен.',
    initialFinalWeight: 'Начальный вес / Конечный вес (Ужарка)',
    warehouse: 'Склад',
    machine: 'Машина',
    operator: 'Оператор',
    date: 'Дата',
    color: 'Цвет',
    rating: 'Оценка',
    notes: 'Заметки',
    info: 'Информация',
    batch: 'Батч',
    viewSchedule: 'View schedule',
    goalsCheck: 'Проверка целей',
    goalsCheckNoData: 'Проверка не выполнялась (нет активных целей или референса)',
    referenceRoast: 'Референс',
  },
  dashboard: {
    dashboard: 'Дашборд',
    time: 'Время',
    date: 'Дата',
    temperature: 'Температура',
    humidity: 'Влажность',
    pressure: 'Давление',
    liveData: 'Данные в реальном времени',
    weatherLoading: 'Загрузка погоды…',
    allowLocation: 'Разрешите доступ к геолокации для погоды',
    // Quick actions
    quickActions: 'Быстрые действия',
    newRoast: 'Новая обжарка',
    addSchedule: 'Расписание',
    addStock: 'Приход зерна',
    // KPI cards
    coffeeLots: 'Лоты кофе',
    totalRoasts: 'Обжарки (30д)',
    blends: 'Бленды',
    roasted30d: 'Обжарено (30д)',
    avgWeightLoss: 'Ср. ужарка',
    pending: 'Ожидание',
    vsPrevPeriod: 'vs пред. 30д',
    new: 'новое',
    // Charts
    roastsAndWeight: 'Обжарки и вес (30 дней)',
    topCoffees: 'Топ кофе / бленды',
    roastLevels: 'Степени обжарки',
    weightLossTrend: 'Тренд ужарки',
    avgLoss: 'Средняя ужарка',
    lowStockAlert: 'Мало на складе',
    allStockHealthy: 'Все запасы в норме!',
    threshold: 'Порог',
    noRoastLevels: 'Нет степеней обжарки',
    noRoastData: 'Нет данных по обжаркам за период',
    noWeightLossData: 'Нет данных об ужарке',
    // QC Summary
    qcSummary: 'Контроль качества',
    qcPassed: 'Пройдено',
    qcWarning: 'Предупреждение',
    qcFailed: 'Не пройдено',
    awaitingQC: 'Ожидает QC',
    noQCData: 'Нет данных QC за период',
    // Goals
    goalsCompliance: 'Соответствие целям',
    goalsMet: 'В норме',
    goalsWarning: 'Данные отсутствуют',
    goalsNotMet: 'Отклонения',
    goalsRate: 'обжарок соответствуют',
    noGoalsData: 'Нет данных о целях',
    // Machine utilization
    machineUtilization: 'Загрузка ростеров',
    roastsOnMachine: 'обжарок',
    noMachineData: 'Нет данных по ростерам',
    // Production tasks
    productionTasksWidget: 'Производственные задачи',
    activeTasks: 'Активных задач',
    pendingCompletion: 'Ожидает выполнения',
    counterProgress: 'Прогресс счётчика',
    noActiveTasksMsg: 'Нет активных задач',
    viewHistory: 'История',
    // KPI summary
    kpiSummary: 'KPI сводка',
    roastedThisMonth: 'Обжарено (мес.)',
    batchesMonth: 'Батчей (мес.)',
    deviations: 'Отклонений',
    qcRatio: 'QC соотношение',
    // Recent roasts / Schedule
    recentRoasts: 'Последние обжарки',
    viewAll: 'Все',
    noRoastsYet: 'Обжарок пока нет',
    startFirstRoast: 'Начните первую обжарку для отображения данных',
    upcomingSchedule: 'Ближайшее расписание',
    scheduledRoast: 'Запланированная обжарка',
    pendingBadge: 'Ожидание',
    noSchedules: 'Нет предстоящих обжарок',
    planNextSession: 'Запланируйте следующую сессию',
    loss: 'ужарка',
  },
  inventory: {
    greenBean: 'Зелёное зерно',
    stock: 'Склад',
    coffees: 'Кофе',
    batches: 'Партии',
  },
  blends: {
    blends: 'Бленды',
  },
  qualityControl: {
    qualityControl: 'Контроль качества',
  },
  schedule: {
    schedule: 'Расписание',
  },
  productionTasks: {
    productionTasks: 'Производственные задачи',
    history: 'История',
  },
  compareRoasts: {
    compare: 'Сравнение обжарок',
  },
  kpi: {
    title: 'KPI Обжарка',
    subtitle: 'Ключевые показатели эффективности обжарки. Только для администратора.',
    roastingKpi: 'KPI Обжарка',
    metric: 'Метрика',
    description: 'Описание',
    fact: 'Факт',
    total: 'Итого',
    addWeek: 'Добавить неделю',
    clickToEdit: 'Нажмите на ячейку для редактирования',
    autoFilled: 'Автозаполнение с сервера',
    autoFilledLegend: 'Данные загружаются автоматически',
    autoFilledClickToOverride: 'Нажмите для ручной корректировки',
    summaryTitle: 'Сводка: среднее процентов (выделенные строки)',
    summaryDesc: 'Среднее по 6 показателям: батчи до зеленого, референсы, рекламации, переоценка, оборудование, соотношение качества.',
    summaryHint: 'Заполнено {n} из {total} показателей.',
  },
  coffeeDialog: {
    addTitle: 'Добавить зелёное зерно',
    editTitle: 'Редактировать зелёное зерно',
    name: 'Наименование',
    namePlaceholder: 'Например: Эфиопия Иргачеффе Гр.1',
    origin: 'Происхождение',
    region: 'Регион',
    variety: 'Сорт',
    processing: 'Обработка',
    physChemTitle: 'Физико-химические показатели',
    moisture: 'Влажность',
    density: 'Плотность',
    create: 'Создать',
  },
  greenBeanData: {
    title: 'Ф/Х данные зелёного зерна',
    subtitle: 'Физико-химические показатели зелёного кофе: влажность, плотность, водная активность.',
    searchPlaceholder: 'Поиск по названию или стране',
    expandAll: 'Развернуть всё',
    collapseAll: 'Свернуть всё',
    measurementDates: 'Даты измерений',
    coffees: 'кофе',
    coffeeName: 'Наименование кофе',
    moisture: 'Влажность',
    density: 'Плотность',
    densityUnit: 'кг/л',
    country: 'Страна',
    selectCountry: '— Выберите страну —',
    measurementDate: 'Дата измерения',
    noSearchResults: 'По запросу ничего не найдено.',
    noData: 'Нет данных о зелёном зерне.',
    addCountry: 'Добавить страну',
    newCountryPlaceholder: 'Название страны',
    addLot: 'Добавить лот зелёного зерна',
    addCoffee: 'Добавить зерно',
    newLotPlaceholder: 'Наименование кофе / лота',
    lot: 'Лот',
    tabActive: 'Актуальные',
    tabArchive: 'Архив измерений',
    archiveEmpty: 'Архив пуст',
    archiveEmptyHint: 'При обновлении данных самое старое измерение перемещается сюда в виде таблицы.',
    hasArchive: 'Есть архивные измерения',
    updateData: 'Обновить данные',
    saveAll: 'Сохранить',
    newMeasurementDate: 'Новая дата измерения',
    newDate: 'Новая дата',
    editModeHint: 'Режим обновления: редактируйте названия и показатели. Нажмите «Сохранить» для отправки на сервер.',
    archiveSnapshotTitle: 'Измерение',
    archivedOn: 'Архивировано',
  },
};

const en: Record<string, unknown> = {
  nav: {
    dashboard: 'Dashboard',
    roasts: 'Roasts',
    greenBean: 'Green Bean',
    greenBeanData: 'Green Bean F/C Data',
    blends: 'Blends',
    qualityControl: 'Quality Control',
    schedule: 'Schedule',
    productionTasks: 'Production Tasks',
    settings: 'Settings',
  },
  header: {
    hideMenu: 'Hide menu',
    showMenu: 'Show menu',
    tagline: 'UNLOCKING POTENTIAL',
    platform: 'Coffee Roasting Platform',
    themeLight: 'Light theme',
    themeDark: 'Dark theme',
    langRu: 'Russian',
    langEn: 'English',
    online: 'Online',
    offline: 'Offline',
    logout: 'Log out',
  },
  sidebar: {
    roastingMode: 'Roasting Mode',
    readyToCreate: 'Ready to create',
  },
  login: {
    signInToAccount: 'Sign in to your account',
    email: 'Email',
    password: 'Password',
    rememberMe: 'Remember me',
    signIn: 'Sign in',
    signingIn: 'Signing in...',
    invalidEmail: 'Invalid email address',
    passwordRequired: 'Password is required',
    loginFailed: 'Login failed',
  },
  common: {
    save: 'Save',
    cancel: 'Cancel',
    close: 'Close',
    delete: 'Delete',
    edit: 'Edit',
    add: 'Add',
    search: 'Search',
    filter: 'Filter',
    refresh: 'Refresh',
    export: 'Export',
    loading: 'Loading...',
    noData: 'No data',
    yes: 'Yes',
    no: 'No',
    showPassword: 'Show password',
    hidePassword: 'Hide password',
  },
  users: {
    users: 'Users',
    createUser: 'Create User',
    username: 'Username',
    role: 'Role',
    status: 'Status',
    active: 'Active',
    inactive: 'Inactive',
    actions: 'Actions',
    manageUsers: 'Manage users, roles, and permissions. Only admins can access this page.',
    newPassword: 'New password',
    leaveEmptyToKeep: 'Leave empty to keep unchanged',
    editUser: 'Edit user',
    creating: 'Creating...',
    saving: 'Saving...',
    requiredFields: 'Username, email and password are required',
    you: '(you)',
    createFailed: 'Failed to create user',
    updateRoleFailed: 'Failed to update role',
    deleteFailed: 'Failed to delete user',
    updateFailed: 'Failed to update user',
    usernameEmailRequired: 'Username and email are required',
    passwordMinLengthAlert: 'Password must be at least 8 characters',
    cannotDeleteYourself: 'You cannot delete yourself',
    confirmDeleteUser: 'Delete user {name}?',
    loadingUsers: 'Loading users...',
    failedToLoadUsers: 'Failed to load users.',
    addUser: 'Add User',
    createNewUser: 'Create New User',
    displayName: 'Display name',
    min8Chars: 'Min 8 characters',
    allUsers: 'All Users',
    created: 'Created',
    editTitle: 'Edit',
    deleteUserTitle: 'Delete user',
    cannotDeleteYourselfTitle: 'Cannot delete yourself',
    noUsersFound: 'No users found.',
  },
  settings: {
    settings: 'Settings',
    pageSubtitle: 'Machines, profile, interface and other options',
    machines: 'Machines',
    profile: 'Profile',
    profileDesc: 'Account info and sign out.',
    notifications: 'Notifications',
    notificationsDesc: 'WebSocket and sound notifications.',
    interface: 'Interface',
    goals: 'Goals',
    about: 'About',
    myMachines: 'My machines',
    addFromCatalog: 'Add from Artisan catalog',
    orEnterName: 'Or enter name manually',
    add: 'Add',
    machinesInOrg: 'Machines in organization',
    noMachinesYet: 'No machines yet. Add from catalog or enter a name.',
    addMachinesInSettings: 'Add machines in Settings',
    addError: 'Error adding',
    changePassword: 'Change password',
    currentPassword: 'Current password',
    newPassword: 'New password',
    repeatNewPassword: 'Repeat new password',
    minChars: 'At least 8 characters',
    changePasswordBtn: 'Change password',
    passwordChanged: 'Password changed successfully',
    passwordChangeError: 'Error changing password',
    logoutAccount: 'Log out',
    dateFormat: 'Date format',
    weightFormat: 'Weight units',
    tempFormat: 'Temperature units',
    defaultPageSize: 'Default list size',
    wsNotifications: 'WebSocket notifications',
    wsNotificationsDesc: 'Receive push notifications for schedule and new roasts',
    soundNotifications: 'Sound notifications',
    soundNotificationsDesc: 'Play sound on new events',
    enabled: 'Enabled',
    aboutApp: 'About',
    aboutDesc: 'Information about Artisan+ Local Server.',
    version: 'Frontend version',
    artisanConnect: 'Artisan connection: set server URL in Artisan settings.',
    interfaceDesc: 'Language, date, weight, temperature formats and default list size.',
    goalsDesc: 'Roast goals for comparing batches with reference profiles.',
    artisanServer: 'Artisan+ Local Server',
    frontendVersion: 'Frontend version',
    compatibleWithArtisan: 'Compatible with Artisan desktop app for coffee roast profiling.',
    passwordsDoNotMatch: 'Passwords do not match',
    passwordMinLength: 'New password must be at least 8 characters',
  },
  roasts: {
    roasts: 'Roasts',
    addRoast: 'Add roast',
    date: 'Date',
    name: 'Name',
    warehouse: 'Warehouse',
    machine: 'Machine',
    operator: 'Operator',
    greenWeight: 'Green weight',
    roastedWeight: 'Roasted weight',
    shrinkage: 'Shrinkage',
    dtr: 'DTR',
    beanColor: 'Bean color',
    grindColor: 'Grind color',
    coffee: 'Coffee',
    rating: 'Rating',
    qualityControl: 'QC',
    downloadProfile: 'Download profile',
    uploadProfile: 'Upload profile',
    delete: 'Delete',
    compare: 'Compare',
    export: 'Export',
    printStickers: 'Print stickers',
    columns: 'Columns',
    close: 'Close',
    filters: 'Filters',
    byMachine: 'By machine',
    byCoffeeBlend: 'By coffee / blend',
    byRoastName: 'By roast name',
    byId: 'By ID',
    byDate: 'By date',
    byUser: 'By user',
    selectMachine: '— Select machine —',
    selectCoffee: '— Coffee —',
    selectBlend: '— Blend —',
    partOfName: 'Part of name',
    apply: 'Apply',
    reset: 'Reset',
    exportRoasts: 'Export roasts',
    format: 'Format',
    scope: 'Export scope',
    currentPage: 'Current page',
    allFiltered: 'All filtered',
    selectedOnly: 'Selected only',
    records: 'records',
    references: 'References',
    removeReference: 'Remove reference',
    removeReferenceConfirm: 'Remove this roast from references? Roast will remain in system.',
    clickToEdit: 'Click to edit',
    inQC: 'Mark for quality control',
    editRoast: 'Edit roast',
    goalsStatusGreen: 'All goals met',
    goalsStatusRed: 'Goals not met',
    goalsStatusYellow: 'Missing data for check',
    deleteError: 'Error deleting',
    saveError: 'Error saving',
    removeReferenceError: 'Error removing reference',
    selectRoastsForExport: 'Select roasts to export',
    noDataForExport: 'No data to export',
    tabs: 'Tabs',
    tabRoasts: 'Roasts',
    tabReferences: 'References',
    filterOptional: 'Filter (optional):',
    machineOptional: 'Machine (optional)',
    refresh: 'Refresh',
    loading: 'Loading…',
    actions: 'Actions',
    noReferencesByFilter: 'No reference roasts for selected filter.',
    noReferences: 'No reference roasts.',
    selectCoffeeOption: 'Select coffee',
    selectBlendOption: 'Select blend',
    blend: 'Blend',
    exportTitle: 'Artisan+ — Roast export',
    exportDate: 'Export date',
    recordsCount: 'Records',
    period: 'Period',
    roaster: 'Roaster',
    userFilter: 'User',
    searchPlaceholder: 'Search',
    shortName: 'Name',
    shortMachine: 'Mach.',
    shortOperator: 'Oper.',
    shortGreenWeight: 'Green kg',
    shortRoastedWeight: 'Roast kg',
    shortBeanColor: 'Bean col.',
    shortGrindColor: 'Grind col.',
    displayInList: 'Display in list',
    filtersTitle: 'Roast filters',
    addMachinesInSettings: 'Add machines in Settings',
    noSearchResults: 'No results for this search. Change search or clear field.',
    noRoastsToDisplay: 'No roasts to display',
    devTimeTitle: 'Development time / %',
    ratingTitle: 'Rating',
    filterIdPlaceholder: 'e.g. 2829',
    dateFrom: 'From',
    dateTo: 'To',
    sameDateHint: 'Use same dates for a single day',
    selectUser: '— Select user —',
    currentPageRecords: 'Current page ({n} records)',
    selectedRecords: 'Selected only ({n} records)',
    exportFileHint: 'Visible columns will be exported. Filename: roasts_export_YYYY-MM-DD_HH-MM',
    exportButton: 'Export',
    perPage: 'Per page:',
    noRecords: 'No records',
    showingRange: 'Showing {from}–{to} of {total}',
    customSticker: 'Text sticker',
    customStickerTitle: 'Print text sticker',
    customStickerHint: 'Enter the text you want to see on the sticker. Each line will be a separate line on the sticker.',
    customStickerPrint: 'Print',
    customStickerPreviewLabel: 'Sticker text',
    customStickerFont: 'Font',
    customStickerFontSize: 'Font size, pt',
    customStickerStyle: 'Style',
    customStickerBold: 'Bold',
    customStickerItalic: 'Italic',
    customStickerUnderline: 'Underline',
    customStickerPreview: 'Sticker preview',
  },
  roastDetail: {
    back: 'Back',
    profileLoaded: 'Profile .alog loaded',
    profileNotLoaded: 'Profile .alog not loaded',
    downloadProfile: 'Download profile',
    uploadProfile: 'Upload profile',
    beansNotes: 'Beans notes',
    removeFromReferences: 'Remove from references',
    removeFromRefConfirm: 'Remove this profile from references?',
    createReference: 'Create reference',
    replaceReference: 'Replace reference',
    deleteRoast: 'Delete',
    deleteRoastConfirm: 'Delete this roast? Stock will be restored.',
    initialFinalWeight: 'Initial / Final weight (Shrinkage)',
    warehouse: 'Warehouse',
    machine: 'Machine',
    operator: 'Operator',
    date: 'Date',
    color: 'Color',
    rating: 'Rating',
    notes: 'Notes',
    info: 'Information',
    batch: 'Batch',
    viewSchedule: 'View schedule',
    goalsCheck: 'Goals check',
    goalsCheckNoData: 'Check was not run (no active goals or reference)',
    referenceRoast: 'Reference',
  },
  dashboard: {
    dashboard: 'Dashboard',
    time: 'Time',
    date: 'Date',
    temperature: 'Temperature',
    humidity: 'Humidity',
    pressure: 'Pressure',
    liveData: 'Live data',
    weatherLoading: 'Loading weather…',
    allowLocation: 'Allow location access for weather',
    // Quick actions
    quickActions: 'Quick actions',
    newRoast: 'New roast',
    addSchedule: 'Schedule',
    addStock: 'Add stock',
    // KPI cards
    coffeeLots: 'Coffee lots',
    totalRoasts: 'Roasts (30d)',
    blends: 'Blends',
    roasted30d: 'Roasted (30d)',
    avgWeightLoss: 'Avg shrinkage',
    pending: 'Pending',
    vsPrevPeriod: 'vs prev 30d',
    new: 'new',
    // Charts
    roastsAndWeight: 'Roasts & weight (last 30 days)',
    topCoffees: 'Top coffees / blends',
    roastLevels: 'Roast levels',
    weightLossTrend: 'Shrinkage trend',
    avgLoss: 'Avg shrinkage',
    lowStockAlert: 'Low stock alert',
    allStockHealthy: 'All stock levels are healthy!',
    threshold: 'Threshold',
    noRoastLevels: 'No roast levels',
    noRoastData: 'No roast data for the period',
    noWeightLossData: 'No shrinkage data',
    // QC Summary
    qcSummary: 'Quality control',
    qcPassed: 'Passed',
    qcWarning: 'Warning',
    qcFailed: 'Failed',
    awaitingQC: 'Awaiting QC',
    noQCData: 'No QC data for the period',
    // Goals
    goalsCompliance: 'Goals compliance',
    goalsMet: 'Compliant',
    goalsWarning: 'Missing data',
    goalsNotMet: 'Non-compliant',
    goalsRate: 'roasts compliant',
    noGoalsData: 'No goals data',
    // Machine utilization
    machineUtilization: 'Roaster utilization',
    roastsOnMachine: 'roasts',
    noMachineData: 'No roaster data',
    // Production tasks
    productionTasksWidget: 'Production tasks',
    activeTasks: 'Active tasks',
    pendingCompletion: 'Pending completion',
    counterProgress: 'Counter progress',
    noActiveTasksMsg: 'No active tasks',
    viewHistory: 'History',
    // KPI summary
    kpiSummary: 'KPI summary',
    roastedThisMonth: 'Roasted (month)',
    batchesMonth: 'Batches (month)',
    deviations: 'Deviations',
    qcRatio: 'QC ratio',
    // Recent roasts / Schedule
    recentRoasts: 'Recent roasts',
    viewAll: 'View all',
    noRoastsYet: 'No roasts yet',
    startFirstRoast: 'Start your first roast to see data here',
    upcomingSchedule: 'Upcoming schedule',
    scheduledRoast: 'Scheduled roast',
    pendingBadge: 'Pending',
    noSchedules: 'No upcoming schedules',
    planNextSession: 'Plan your next roasting session',
    loss: 'loss',
  },
  inventory: {
    greenBean: 'Green Bean',
    stock: 'Stock',
    coffees: 'Coffees',
    batches: 'Batches',
  },
  blends: {
    blends: 'Blends',
  },
  qualityControl: {
    qualityControl: 'Quality Control',
  },
  schedule: {
    schedule: 'Schedule',
  },
  productionTasks: {
    productionTasks: 'Production Tasks',
    history: 'History',
  },
  compareRoasts: {
    compare: 'Compare roasts',
  },
  kpi: {
    title: 'KPI Roasting',
    subtitle: 'Key performance indicators for roasting. Admin only.',
    roastingKpi: 'KPI Roasting',
    metric: 'Metric',
    description: 'Description',
    fact: 'Fact',
    total: 'Total',
    addWeek: 'Add week',
    clickToEdit: 'Click on cell to edit',
    autoFilled: 'Auto-filled from server',
    autoFilledLegend: 'Data is loaded automatically',
    autoFilledClickToOverride: 'Click to override manually',
    summaryTitle: 'Summary: average of percentages (highlighted rows)',
    summaryDesc: 'Average of 6 metrics: batches to green, references, complaints, re-evaluation, equipment, quality ratio.',
    summaryHint: '{n} of {total} metrics filled.',
  },
  coffeeDialog: {
    addTitle: 'Add Green Bean',
    editTitle: 'Edit Green Bean',
    name: 'Name',
    namePlaceholder: 'e.g. Ethiopia Yirgacheffe Gr.1',
    origin: 'Origin',
    region: 'Region',
    variety: 'Variety',
    processing: 'Processing',
    physChemTitle: 'Physical-Chemical Data',
    moisture: 'Moisture',
    density: 'Density',
    create: 'Create',
  },
  greenBeanData: {
    title: 'Green Bean F/C Data',
    subtitle: 'Physical-chemical parameters of green coffee: moisture, density, water activity.',
    searchPlaceholder: 'Search by name or country',
    expandAll: 'Expand all',
    collapseAll: 'Collapse all',
    measurementDates: 'Measurement dates',
    coffees: 'coffees',
    coffeeName: 'Coffee name',
    moisture: 'Moisture',
    density: 'Density',
    densityUnit: 'kg/l',
    country: 'Country',
    selectCountry: '— Select country —',
    measurementDate: 'Measurement date',
    noSearchResults: 'No results found.',
    noData: 'No green bean data available.',
    addCountry: 'Add country',
    newCountryPlaceholder: 'Country name',
    addLot: 'Add green bean lot',
    addCoffee: 'Add coffee',
    newLotPlaceholder: 'Coffee / lot name',
    lot: 'Lot',
    tabActive: 'Active',
    tabArchive: 'Measurement Archive',
    archiveEmpty: 'Archive is empty',
    archiveEmptyHint: 'When data is updated, the oldest measurement moves here as a table.',
    hasArchive: 'Has archived measurements',
    updateData: 'Update data',
    saveAll: 'Save',
    newMeasurementDate: 'New measurement date',
    newDate: 'New date',
    editModeHint: 'Update mode: edit names and values. Click Save to submit to server.',
    archiveSnapshotTitle: 'Measurement',
    archivedOn: 'Archived on',
  },
};

const flatRu = flatten(ru);
const flatEn = flatten(en);

const translations: Record<Language, Record<string, string>> = {
  ru: flatRu,
  en: flatEn,
};

function getByPath(lang: Language, key: string): string {
  const map = translations[lang];
  const value = map[key];
  if (typeof value === 'string') return value;
  return (translations.ru[key] as string) ?? key;
}

export function t(lang: Language, key: string): string {
  return getByPath(lang, key);
}

export type TranslationKey = keyof typeof flatRu;
